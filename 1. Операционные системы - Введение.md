#Operating_Systems #OS_Processes
## 1. Определение и назначение операционных систем

### Структура компьютерной системы

Любая вычислительная система состоит из трёх основных компонентов:
- **Аппаратура (Hardware)** — физические компоненты компьютера, такие как процессор, память, устройства ввода/вывода и т.д.
- **Системные программы** — программы, которые управляют аппаратным обеспечением и предоставляют платформу для выполнения прикладного программного обеспечения. К системному программному обеспечению относятся операционные системы, драйверы устройств, утилиты и т.д.
- **Прикладные программы** — программы, которые выполняют конкретные задачи для пользователя, такие как текстовые редакторы, браузеры, игры и т.д.	
![[OS 1.png]]

### Определения операционной системы

**Операционная система (ОС)** — это программное обеспечение низкого уровня, которое:
- Обеспечивает взаимодействие пользователей и приложений высокого уровня с оборудованием вычислительной системы
- Управляет доступом к данным и другим программам
- Выполняет базовые задачи: распознавание ввода с клавиатуры, вывод на дисплей, хранение файлов и директорий на диске, управление периферийным оборудованием
#### Основные функции ОС 
1. **Управление процессами**: создание, планирование и завершение процессов.
2. **Управление памятью**: распределение и освобождение памяти для процессов.
3. **Управление файловой системой**: создание, удаление, чтение и запись файлов.
4. **Управление устройствами ввода/вывода**: взаимодействие с периферийными устройствами.
5. **Обеспечение безопасности и защиты данных**: контроль доступа к ресурсам системы.
6. **Обеспечение пользовательского интерфейса**: предоставление средств взаимодействия пользователя с системой.
7. **Обеспечение сетевых функций**: управление сетевыми соединениями и обмен данными между компьютерами.
8. **Обеспечение многозадачности**: поддержка одновременного выполнения нескольких процессов.

### Назначение ОС
1. **Абстрагирование аппаратного обеспечения**: ОС скрывает детали работы оборудования, предоставляя удобный интерфейс для пользователей и приложений.
2. **Управление ресурсами**: ОС эффективно распределяет ресурсы системы между различными процессами и пользователями.
3. **Обеспечение стабильности и надежности**: ОС обеспечивает защиту от сбоев и ошибок, минимизируя влияние проблем на работу системы.
4. **Обеспечение совместимости**: ОС обеспечивает совместимость между различными приложениями и аппаратными платформами.
5. **Обеспечение удобства использования**: ОС предоставляет пользователям удобные средства для взаимодействия с системой и выполнения задач.
6. **Поддержка развития программного обеспечения**: ОС предоставляет платформу для разработки и выполнения новых приложений и технологий.


### Три точки зрения на ОС
Операционную систему можно рассматривать с разных точек зрения:
#### 1. ОС как виртуальная машина
- Прячет детали реализации аппаратуры
- Предоставляет пользователю виртуальную машину, которую легче использовать
- Создаёт абстракции для работы с устройствами
#### 2. ОС как менеджер ресурсов
- Каждая программа, имеющая на это «право», получает «свою долю» ресурсов
- Управляет распределением процессорного времени, памяти, устройств ввода-вывода
- Обеспечивает справедливое распределение ресурсов между конкурирующими задачами

Что бы несколько программ могло работать с одним ресурсом одновременно, необходима система управления ресурсами, которая будет:
- Координировать доступ к ресурсам
- Предотвращать конфликты и взаимоблокировки
- Обеспечивать эффективное использование ресурсов

Способы распределения ресурсов:
- **Временное разделение**: ресурсы выделяются на определённый промежуток времени (например, процессорное время)
- **Пространственное разделение**: ресурсы выделяются в виде отдельных блоков (например, память)
#### 3. ОС как защитник
- Программа, не подтвердившая своих «прав», не получит ресурсов
- Защищает данные и программы от несанкционированного доступа
- Изолирует процессы друг от друга
---
## 2. Услуги и сервисы ОС
### Основные услуги (часть 1)
#### Интерфейс пользователя (UI)
**CLI (Command Line Interface)** — командная строка
- Текстовый интерфейс для ввода команд
- Высокая гибкость и автоматизация
- Требует знания синтаксиса команд
**Batch Interface** — интерфейс пакетной обработки
- Команды языка управления заданиями (ЯУЗ) являются частью исполняемого файла
- Позволяет автоматизировать последовательность операций
- Программы выполняются без участия пользователя
**GUI (Graphical User Interface)** — графический интерфейс
- Разработан в Xerox PARC в 1970-х годах
- Первая реализация: Xerox Alto (1973)
- Интуитивно понятный, основан на визуальных элементах (окна, иконки, меню)
#### Исполнение программ
- Загрузка программы в память и её исполнение
- Управление завершением программы (нормальное или аварийное)
- Обеспечение взаимодействия между программами
- **Абстракция**: пользователь не вдаётся в детали распределения памяти и планирования процессора
#### Операции ввода/вывода
- Предоставление средств для доступа к устройствам ввода-вывода
- **Абстракция**: пользователь может не вникать в детали функционирования конкретных устройств
- Унифицированный интерфейс для работы с различными устройствами
#### Работа с файловой системой
- Создание, чтение, запись и удаление файлов и директорий
- Организация хранения данных на дисках
- Управление правами доступа к файлам
#### Взаимодействие процессов
- Процессы, работающие на одном или разных компьютерах, могут взаимодействовать для обмена информацией
- Механизмы межпроцессного взаимодействия (IPC)
- Синхронизация и координация действий
#### Обнаружение ошибок
- Мониторинг состояния системы
- Обработка аппаратных и программных ошибок
- Предоставление информации об ошибках пользователям и программам
#### Гарантия эффективности
- Оптимальное использование аппаратных ресурсов
- Минимизация времени простоя
- Балансировка нагрузки
#### Предоставление ресурсов
- Поддержка многозадачности (много задач)
- Поддержка многопользовательского режима (много пользователей)
- Различные типы ресурсов: процессорное время, память, устройства
#### Учёт использования ресурсов
- Ведение статистики использования
- Квотирование ресурсов
- Мониторинг производительности
#### Защита и безопасность
- Аутентификация и авторизация пользователей
- Разграничение прав доступа
- Защита от вредоносного ПО
#### Многозадачность
- Поддержка одновременного выполнения нескольких процессов
- Планирование процессов
- Управление переключением контекста
- Обеспечение отзывчивости системы
#### Многопользовательская работа
- Поддержка одновременной работы нескольких пользователей
- Разграничение прав доступа и ресурсов
- Учёт активности пользователей
- Обеспечение безопасности данных
---
## История развития ОС
### Первое поколение ЭВМ (1945-1955)
**Ключевые характеристики:**
- **Архитектура фон Неймана**: концепция программы, хранимой в памяти (июнь 1945)
- **Элементная база**: электронные лампы
- **Устройства ввода**: пульт управления, коммутационная доска (plug board)
- **Языки программирования**: машинный язык, позже появился ассемблер
- **Операционных систем нет** — каждая программа полностью управляла компьютером

**К концу периода:**
- Появился язык Fortran
- Разработаны первые компиляторы

**Проблемы:**
- Низкая эффективность использования машинного времени
- Сложность программирования
### Второе поколение (1955-1965)
**Ключевые характеристики:**
- **Элементная база**: транзисторы (вместо ламп)
- **Промышленное применение** компьютеров
- **Алгоритмические языки**: ALGOL-58, LISP, COBOL, ALGOL-60, PL/1

**Появление пакетных систем (Batch Systems):**
- **Проблема**: большие простои во время операций ввода-вывода (I/O)
- **Решение**: пакетная обработка заданий
- **Язык управления заданиями (ЯУЗ)** для описания последовательности операций

**Типичное задание:**
Колода перфокарт содержала:
- Управляющие карты (директивы ЯУЗ)
- Программу
- Данные

**Недостатки:**
- Отсутствие взаимодействия с программой во время выполнения
- Одна программа полностью занимает процессор
### Третье поколение (1965-1980)
**Ключевые характеристики:**
- **Элементная база**: интегральные микросхемы (ИМС)

**Мультипрограммирование:**
- В главной памяти могут находиться несколько программ одновременно
- Процессор переключается между программами
- Повышение эффективности использования ресурсов

**SPOOL (Simultaneous Peripheral Operation On Line):**
- Совмещение исполнения программ и операций ввода-вывода
- Буферизация данных на быстрых устройствах (дисках)

**Разделение времени (Time-sharing):**
- Быстрое переключение между задачами
- Создание иллюзии одновременной работы для пользователей
- Интерактивная работа с системой

**Другие достижения:**
- **Виртуальная память** — возможность запускать программы, размер которых превышает объём физической памяти
- **Файловые системы** — иерархическая организация данных
- **Переносимость ОС** — возможность использования на разных типах компьютеров

**Важные системы:**
- IBM 360/370
- PDP-11
- **UNIX** (одна из первых ОС, написанная на языке высокого уровня — С, 1971)
- CP/M
### Четвёртое поколение (1980-настоящее время)
**Ключевые характеристики:**
- **Элементная база**: БИС (большие интегральные схемы), СБИС (сверхбольшие ИС)
- **Персональные компьютеры** — миниатюризация и доступность
- **Графические интерфейсы пользователя** (GUI)

**1980-е годы:**
- Появление персональных компьютеров (IBM PC, Apple Macintosh)
- Проект Athena (MIT) — разработка распределённых вычислительных сред
- **X-Windows** — графическая система для UNIX
- Развитие **сетевых ОС** — поддержка работы в компьютерных сетях
- **Распределённые ОС** — координация работы нескольких компьютеров

**Современные тенденции:**
- Мобильные ОС
- Облачные вычисления
- Виртуализация
- Контейнеризация
---
## Классификация операционных систем

### По архитектурным особенностям и структуре
#### 1) Монолитноядерные системы
**Характеристики:**
- Все компоненты ОС являются частями одной большой программы
- Ядро работает в едином адресном пространстве
- Высокая производительность (нет накладных расходов на переключение между компонентами)
**Структура:**
- Чётко просматриваются уровни исполнения
- Интерфейс системных вызовов
**Примеры:** традиционные UNIX, Linux (в основе)
#### 2) Многослойные системы (Layered)
**Характеристики:**
- ОС организована в виде иерархии слоёв
- Каждый слой предоставляет сервисы вышестоящему слою
- Каждый слой использует только сервисы нижестоящего слоя
**Преимущества:**
- Модульность
- Упрощение разработки и отладки
**Пример:** система THE (Technische Hogeschool Eindhoven)
#### 3) Виртуальные машины
**Характеристики:**
- ОС создаёт иллюзию нескольких независимых виртуальных компьютеров
- Каждая виртуальная машина — точная копия физической
**Преимущества:**
- Полная изоляция
- Возможность запуска разных ОС
**Пример:** VM/370 с системой CMS (Conversational Monitor System)
#### 4) Клиент-серверные системы
**Характеристики:**
- Минимальное ядро (микроядро)
- Большинство сервисов реализованы как серверные процессы
- Клиенты взаимодействуют с серверами через передачу сообщений
**Преимущества:**
- Меньше кода в ядре → проще верификация
- Подходит для распределённых систем
- Отказоустойчивость (сбой одного сервера не приводит к краху системы)
**Примеры:** Minix, современные микроядерные ОС
#### 5) Микроядро
**Характеристики:**
- Минимальное ядро с базовыми функциями
- Остальные компоненты работают в пользовательском режиме
**Преимущества:**
- Высокая надёжность
- Гибкость
**Недостатки:**
- Накладные расходы на переключение контекста
#### 6) Смешанные системы
**Характеристики:**
- Запуск монолитноядерной системы поверх микроядра
- Компромисс между производительностью и надёжностью
**Пример:** FreeBSD поверх Mach
### По реализации многозадачности

#### 1) Однозадачные системы
- В каждый момент времени выполняется только одна задача
- **Примеры:** MS-DOS, ранние версии MacOS
#### 2) Многозадачные системы
**С вытеснением (Preemptive multitasking):**
- ОС может принудительно прервать выполнение задачи
- Гарантия отзывчивости системы
- **Примеры:** Windows NT и выше, UNIX/Linux, современные ОС
**Без вытеснения (Non-preemptive/Cooperative multitasking):**
- Задача сама решает, когда передать управление
- Риск «зависания» системы, если задача не отдаёт управление
- **Примеры:** Windows 3.x, ранние MacOS
### По поддержке многопользовательского режима
#### 1) Однопользовательские системы
- Рассчитаны на одного пользователя
- **Примеры:** MS-DOS, Windows 9x (в основе)
#### 2) Многопользовательские системы
- Одновременная работа нескольких пользователей
- Разграничение прав доступа
- Учёт ресурсов
- **Примеры:** UNIX/Linux, Windows Server
### По многопроцессорной обработке
#### 1) Симметричные (SMP — Symmetric MultiProcessing)
- Все процессоры равноправны
- Общая память
- Любой процессор может выполнять любую задачу
#### 2) Асимметричные (AMP — Asymmetric MultiProcessing)
- Процессоры имеют различные роли
- Главный процессор управляет работой остальных
### По назначению
#### 1) Пакетные системы (Batch)
- Обработка заданий без участия пользователя
- Максимизация пропускной способности
- **Применение:** научные вычисления, обработка больших объёмов данных
#### 2) Системы разделения времени (Time-sharing)
- Интерактивная работа пользователей
- Быстрое переключение между задачами
- **Применение:** многопользовательские серверы
#### 3) Системы реального времени (Real-time)
- Гарантированное время отклика
- **Жёсткое реальное время**: система не допускает пропуска дедлайна. То есть, если задача не будет выполнена в установленный срок, это приведёт к катастрофическим последствиям (управление ядерным реактором, авионика).
- **Мягкое реальное время**: система старается выполнить задачи в срок, но пропуск дедлайна не приводит к серьёзным последствиям (мультимедийные приложения, онлайн-игры).
#### 4) Автономные системы
- Работают независимо от других компьютеров
#### 5) Сетевые системы
- Поддержка работы в сети
- Обмен данными с другими компьютерами
#### 6) Распределённые системы
- Группа независимых компьютеров выглядит как единая система
- Прозрачность для пользователя
---
## Критерии оценки ОС
### - Удобство использования (Usability)
#### 1) Устойчивость (Robustness)
- Система воспринимает любой ввод без ошибок
- Обнаруживает и контролирует ошибки
- Корректная обработка некорректных данных
#### 2) Консистентность (Consistency)
- Единообразие интерфейса
- **Пример**: если «-» обозначает опции/флаги в одной команде, такое же значение он имеет в других
- Соблюдение соглашений
**Principle of Least Astonishment (Правило минимального удивления):**
- Система должна вести себя предсказуемо
- Интуитивно понятное поведение
#### 3) Пропорциональность (Proportionality)
- **Простые, дешёвые и частые операции** должны выполняться легко
- **Сложные, дорогие и опасные операции** должны требовать дополнительных усилий
- Баланс между удобством и безопасностью
#### 4) Всепрощение (Forgiving)
- Возможность исправления ошибок
- Адекватные сообщения об ошибках
- **Пример**: команда `rm` (удаление файлов) — должна предупреждать о необратимых действиях
#### 5) Удобство (Convenience)
- Не нужно повторять действия
- Автоматизация рутинных операций
- Поддержка сценариев (scripts)
#### 6) Мощность (Power)
- Наличие высокоуровневых средств
- Возможность выполнения сложных задач
- Гибкость и расширяемость

### - Средства работы (Facilities)

#### 1) Достаточность
- Средства достаточны для выполнения поставленных задач
- Полный набор функций
#### 2) Завершённость
- Все средства реализованы полностью
- Нет «недоделанных» функций
#### 3) Соответствие назначению
- Средства соответствуют области применения
- **Пример**: не следует использовать поля фиксированной ширины при вводе с терминала

### - Затраты ресурсов (Resource Usage, Cost)
#### 1) Эффективность сервисов
- Низкая стоимость предоставления услуг
- Оптимальное использование ресурсов
#### 2) Хорошие алгоритмы
- Использование эффективных алгоритмов планирования, управления памятью и т.д.
- Минимизация накладных расходов
#### 3) Низкая нагрузка (Low overhead)
- Стоимость простоя должна быть низкой
- ОС не должна потреблять слишком много ресурсов
#### 4) Низкая стоимость поддержки (владения)
- Простота администрирования
- Надёжность
- Доступность обновлений

### - Адаптивность (Adaptability)
#### 1) Приспособляемость к окружению
- Поддержка нужных действий
- Отсутствие ненужных ограничений
- **Принцип**: то, что люди делают больше всего, должно делаться легко
#### 2) Изменяемость во времени
- Адаптация к изменению ресурсов
- Поддержка новых устройств
#### 3) Масштабируемость-расширяемость
- Добавление новых возможностей
- Новые средства должны выглядеть согласованно со старыми
- Обратная совместимость

### Реальность

**Важное замечание:**
Реальные ОС не полностью отвечают этим критериям:
- Могут быть неустойчивыми
- Не всегда делают то, для чего разработаны
- Не всегда адаптируются к изменениям
Это цели, к которым следует стремиться при разработке.
---
## Мультипрограммирование

### Определение
**Мультипрограммирование (многозадачность, multitasking)** — это способ организации вычислительного процесса, при котором на одном процессоре попеременно выполняются сразу несколько программ.

**Степень мультипрограммирования (multiprogramming degree)** — количество программ, находящихся в памяти одновременно и претендующих на использование процессора.

**Что разделяется:**
- Процессор
- Оперативная память
- Внешняя память
- Устройства ввода-вывода
- Данные

### Цели мультипрограммирования
Мультипрограммирование призвано повысить **эффективность** использования вычислительной системы.

**Критерии эффективности:**
#### 1) Пропускная способность (Throughput)
- Количество задач, выполняемых вычислительной системой в единицу времени
- **Средство достижения**: уменьшить простои процессора во время операций ввода-вывода
- Пока одна программа ждёт завершения I/O, другая может использовать процессор
#### 2) Удобство работы пользователей
- Возможность интерактивно работать одновременно с несколькими приложениями на одной машине
- **Механизм**: разделение времени (time-sharing)
- Создание иллюзии одновременной работы
#### 3) Реактивность системы
- Способность системы выдерживать заранее заданные (возможно, очень короткие) интервалы времени между запуском программы и получением результата
- **Применение**: системы реального времени
- Набор программ, запускаемых по прерыванию (реакция на внешние события)
### Аппаратная поддержка мультипрограммирования
Для реализации мультипрограммирования требуется поддержка со стороны аппаратуры:
#### 1) Реализация защитных механизмов
**Привилегированные и непривилегированные команды:**
- Программы не должны иметь самостоятельного доступа к распределению ресурсов
- **Привилегированные команды** (например, команды ввода-вывода) могут исполняться только операционной системой
- **Непривилегированные команды** могут исполняться прикладными программами
- ОС работает в **привилегированном режиме** (kernel mode)
- Прикладные программы работают в **пользовательском режиме** (user mode)
- **Kernel mode** — привилегированный режим работы процессора, в котором выполняется код операционной системы с полным доступом ко всем аппаратным ресурсам.
- **User mode** — непривилегированный режим работы процессора, в котором выполняется код пользовательских программ с ограниченным доступом к аппаратным ресурсам.

**Переход между режимами:**
- При выполнении привилегированной команды происходит переключение в привилегированный режим
- При завершении привилегированной операции происходит возврат в пользовательский режим
- Осуществляется с помощью механизма прерываний

**Защита памяти:**
- Изоляция конкурирующих пользовательских программ друг от друга
- Защита ОС от программ пользователей
- Аппаратные механизмы: базовые и граничные регистры, таблицы страниц

#### 2) Наличие прерываний
**Внешние прерывания (Hardware Interrupts):**
- Оповещают ОС о том, что произошло асинхронное событие
- **Примеры**:
  - Завершилась операция ввода-вывода
  - Нажатие клавиши на клавиатуре
  - Таймер

**Внутренние прерывания (Исключительные ситуации, Exceptions):**
- Возникают, когда выполнение программы привело к ситуации, требующей вмешательства ОС
- **Примеры**:
  - Деление на ноль
  - Попытка нарушения защиты памяти
  - Недопустимая инструкция

### Роль ОС в мультипрограммировании
#### 1) Системные вызовы (System Calls)
- Интерфейс между прикладной программой и ОС
- Позволяет программам запрашивать сервисы ОС
- Организованы в виде набора функций
#### 2) Планирование заданий (Scheduling)
- Организация очереди из заданий в памяти
- Выделение процессора одному из заданий
- Алгоритмы планирования (FCFS, SJF, приоритетное, round-robin и др.)
#### 3) Контекст процесса
- **Контекст** — совокупность содержимого регистров и структур данных, необходимых для выполнения задания
- При переключении процессора с одного задания на другое необходимо:
  - Сохранить контекст текущего процесса
  - Загрузить контекст следующего процесса
- Обеспечивает правильное продолжение вычислений
#### 4) Управление памятью (Memory Management)
- Память — ограниченный ресурс
- **Стратегии управления памятью**:
  - Размещение программ в памяти
  - Замещение (свопинг)
  - Выборка данных из памяти
  - Виртуальная память
#### 5) Средства коммуникации (IPC — Inter-Process Communication)
- Программы могут пожелать произвести санкционированный обмен данными
- **Механизмы**:
  - Программные каналы (pipes)
  - Очереди сообщений (message queues)
  - Разделяемая память (shared memory)
  - Сокеты (sockets)
#### 6) Средства синхронизации
- Для корректного обмена данными необходима координация действий программ
- **Механизмы**:
  - Семафоры (semaphores)
  - Мьютексы (mutexes)
  - Условные переменные (condition variables)
  - Мониторы (monitors)
---
## Ключевые концепции ОС
### 1) Системные вызовы (System Calls)
**Определение:** Системные вызовы — это интерфейс между пользовательскими программами и ОС (ядром).

**Как работают:**
- При выполнении системного вызова осуществляется прерывание процессора
- Управление передаётся обработчику системного вызова (входит в состав ядра)
- Системный вызов выполняется в **привилегированном режиме** (kernel mode)
- Выполняется в адресном пространстве и контексте вызвавшей задачи

**Реализация:**
- Через команду программного прерывания
- **Синхронное событие** (в отличие от аппаратных прерываний)

**Примеры системных вызовов:**
- Управление процессами: `fork()`, `exec()`, `exit()`, `wait()`
- Файловые операции: `open()`, `read()`, `write()`, `close()`
- Управление памятью: `mmap()`
- Коммуникации: `pipe()`, `socket()`, `send()`, `recv()`

### 2) Прерывания (Interrupts)
#### 1. Аппаратные прерывания (Hardware Interrupts)

**Определение:** Событие, генерируемое внешним (по отношению к процессору) устройством.

**Назначение:**
- Информирует центральный процессор о том, что произошло событие, требующее немедленной реакции
- **Примеры**:
  - Пользователь нажал клавишу
  - Сетевая карта получила пакет
- Сообщает о завершении операции ввода-вывода
- **Пример**: закончено чтение данных с диска в основную память

**Прерывания таймера:**
- Генерируются периодически через фиксированный промежуток времени
- Используются ОС при планировании процессов
- Позволяют реализовать вытесняющую многозадачность

**Характеристики:**
- Каждый тип аппаратных прерываний имеет собственный **номер**, однозначно определяющий источник прерывания
- **Асинхронное событие** — возникает вне зависимости от того, какой код исполняется процессором в данный момент
- Обработка аппаратного прерывания не должна учитывать, какой процесс является текущим

#### 2. Механизм обработки прерываний
**Последовательность действий при аппаратном прерывании:**
1. **Устройство завершает операцию** и устанавливает сигнал на линии прерывания общей шины
2. **Контроллер прерываний**:
   - Проверяет, не занят ли он обработкой прерывания с более высоким приоритетом
   - Если готов, информирует ЦПУ о прерывании
3. **Контроллер помещает номер устройства на шину**
4. **ЦПУ считывает номер** и узнаёт, какое устройство завершило операцию
5. **Прерывание ЦПУ:**
   - Сохраняются PC (Program Counter — счётчик команд) и PSW (Program Status Word — слово состояния программы) в стеке
   - Переключение в режим ядра
6. **Определение адреса ISR** (Interrupt Service Routine — процедура обслуживания прерывания):
   - По номеру устройства находится адрес в векторе прерываний
7. **ISR выполняет свою работу:**
   - Забирает из стека PC и PSW
   - Опрашивает статус устройства
   - Выполняет необходимые действия
8. **После завершения ISR** возвращается к следующей команде прерванного процесса

Линия прерывания - это аппаратный сигнал, используемый устройствами для уведомления центрального процессора (ЦПУ) о необходимости прервать текущую операцию и обработать событие, требующее немедленного внимания. Сигнал идёт через специальную линию на шине прерываний, которая соединяет устройства с контроллером прерываний и ЦПУ.
### 3) Исключительные ситуации (Exceptions, system traps)
**Определение:** Внутренние прерывания, возникающие при выполнении команд процессора.

**Отличие от аппаратных прерываний:**
- **Синхронные** — связаны с выполняемой инструкцией
- Предсказуемы и воспроизводимы

**Примеры:**
- Деление на ноль
- Переполнение
- Недопустимая инструкция
- Нарушение защиты памяти
- Отсутствие страницы в памяти (page fault)

### 4) Файлы (Files)
**Определение:** Абстракция для хранения данных на внешних носителях.

**Характеристики:**
- Последовательность байтов
- Имеет имя и атрибуты
- Организованы в директории (каталоги)

**Операции:**
- Создание, чтение, запись, удаление
- Открытие, закрытие
- Изменение атрибутов

### 5) Процессы и нити (Processes and Threads)

**Процесс:**
- Программа в состоянии выполнения
- Имеет собственное адресное пространство
- Включает: код, данные, стек, регистры, открытые файлы

**Нить (поток, thread):**
- Лёгковесный процесс
- Разделяет адресное пространство с другими нитями того же процесса
- Имеет собственный стек и регистры
---
## Аппаратное обеспечение компьютера
### Компоненты простого ПК
![[OS 2.png]]
**Основные компоненты:**
- **Центральный процессор (ЦПУ, CPU)** — выполняет инструкции
- **Память (RAM)** — хранит программы и данные
- **Шина (Bus)** — соединяет компоненты
- **Контроллеры устройств** — управляют периферийными устройствами
- **Периферийные устройства**:
  - Диски (HDD, SSD)
  - Клавиатура, мышь
  - Монитор
  - Сетевые адаптеры
### Цикл фон Неймана (Исполнение инструкции)
**Три стадии исполнения команды на процессоре:**
1. **Fetch (Выборка)**:
   - Процессор считывает инструкцию из памяти по адресу, указанному в счётчике команд (PC)
   - Инструкция помещается в регистр инструкций (IR)

2. **Decode (Декодирование)**:
   - Блок управления декодирует инструкцию
   - Определяет, какие операции нужно выполнить
   - Готовит необходимые операнды

3. **Execute (Выполнение)**:
   - Выполняется операция
   - Результат записывается в регистр или память
   - Обновляется счётчик команд

**Суперскалярный ЦПУ:**
- Может выполнять несколько инструкций одновременно
- Конвейерная обработка
- Параллельное выполнение (если нет зависимостей по данным)

![[OS 3.png]]

**Цикл исполнения инструкции** повторяется для каждой команды программы: 
- Fetch → Decode → Execute → Interupt (если необходимо) → Fetch → ...
### Иерархия памяти
**Принцип**: компромисс между скоростью, объёмом и стоимостью.
![[OS 5.png]]
**Уровни памяти (от быстрого к медленному):**
1. **Регистры процессора**:
   - Скорость: ~1 нс
   - Объём: десятки байтов
   - Самые быстрые, но очень малы

2. **Кэш L1 (первого уровня)**:
   - Скорость: ~2-4 нс
   - Объём: десятки килобайт
   - Встроен в процессор

3. **Кэш L2 (второго уровня)**:
   - Скорость: ~10 нс
   - Объём: сотни килобайт – несколько мегабайт
   - Обычно встроен в процессор

4. **Кэш L3 (третьего уровня)**:
   - Скорость: ~20-40 нс
   - Объём: несколько мегабайт – десятки мегабайт
   - Может быть общим для нескольких ядер

5. **Основная память (RAM)**:
   - Скорость: ~100 нс
   - Объём: гигабайты
   - Энергозависима

6. **SSD (твердотельные диски)**:
   - Скорость: ~10-100 мкс
   - Объём: десятки – сотни гигабайт, терабайты
   - Энергонезависимы

7. **HDD (жёсткие диски)**:
   - Скорость: ~5-10 мс
   - Объём: терабайты
   - Энергонезависимы, но медленнее SSD

8. **Ленточные накопители, оптические диски**:
   - Ещё медленнее
   - Архивное хранение

### Структура привода диска (HDD)
![[OS 7.png]]
**Компоненты:**
- **Пластины (platters)** — вращающиеся магнитные диски
- **Головки чтения/записи** — считывают и записывают данные
- **Шпиндель** — вращает пластины
- **Актуатор** — перемещает головки

**Организация данных:**
- **Дорожка (track)** — концентрическая окружность на пластине
- **Сектор (sector)** — минимальная единица данных (обычно 512 байт или 4 КБ)
- **Цилиндр (cylinder)** — совокупность дорожек на одинаковом расстоянии от центра на всех пластинах

**Время доступа:**
- Время поиска (seek time) — перемещение головки к нужной дорожке
- Задержка вращения (rotational latency) — ожидание, пока нужный сектор окажется под головкой
	- Время передачи данных

### Защита памяти: сегменты
**Распределение памяти сегментами:**

**Одна пара база-лимит:**
- **Базовый регистр** — начальный адрес сегмента
- **Граничный регистр (лимит)** — размер сегмента
- При обращении к памяти проверяется, что адрес находится в допустимом диапазоне

**Две пары база-лимит:**
- Отдельные сегменты для кода и данных
- Позволяет разделить код (только чтение и исполнение) и данные (чтение и запись)

**Преимущества:**
- Защита памяти от несанкционированного доступа
- Изоляция процессов

![[OS 6.png]]
### Современная вычислительная система
**Компоненты современной системы:**
- **Многоядерные процессоры** — несколько вычислительных ядер на одном кристалле
- **Контроллеры прямого доступа к памяти (DMA)** — позволяют устройствам обмениваться данными с памятью без участия процессора
- **Шина PCI Express** — высокоскоростная шина для подключения устройств
- **Контроллеры USB, SATA** — для подключения периферии
- **GPU (графический процессор)** — специализированный процессор для обработки графики и параллельных вычислений
---
## Структура операционных систем
### Монолитная структура

**Характеристики:**
- ОС представляет собой одну большую программу
- Все компоненты находятся в одном адресном пространстве
- Компоненты могут напрямую вызывать друг друга

**Преимущества:**
- Высокая производительность (нет накладных расходов на передачу сообщений)
- Простота реализации

**Недостатки:**
- Сложность отладки
- Низкая надёжность (ошибка в одном модуле может привести к краху всей системы)
- Сложность модификации

**Примеры:** ранние версии UNIX, MS-DOS

### Слоистая структура (Layered Structure)

**Характеристики:**
- ОС организована в виде иерархии слоёв
- Каждый слой использует только сервисы нижележащего слоя
- Каждый слой предоставляет сервисы вышележащему слою

**Пример: система THE**

**Слои (снизу вверх):**
- **Слой 0: Оборудование**
- **Слой 1: Планирование задач и процессов**
  - Распределение процессорного времени
  - Переключение контекста
- **Слой 2: Управление памятью**
  - Выделение и освобождение памяти
  - Виртуальная память
- **Слой 3: Драйвер устройства связи оператора и консоли**
  - Управление вводом-выводом на консоль
- **Слой 4: Управление вводом-выводом**
  - Драйверы устройств
  - Буферизация
- **Слой 5: Интерфейс пользователя**
  - Командная оболочка
  - Пользовательские программы

**Преимущества:**
- Модульность
- Упрощение проектирования и отладки
- Каждый слой может быть протестирован отдельно

**Недостатки:**
- Сложность определения слоёв
- Накладные расходы на переходы между слоями

### Виртуальные машины
**Концепция:** ОС создаёт иллюзию нескольких независимых виртуальных компьютеров.

**Пример: VM/370**

**Характеристики:**
- Каждая виртуальная машина — точная копия физической машины
- Виртуальная машина имеет своё собственное адресное пространство, процессорное состояние и устройства
- Гипервизор (виртуальная машина монитор) управляет виртуальными машинами и распределяет ресурсы физической машины

**Преимущества:**
- Полная изоляция виртуальных машин
- Возможность запуска разных ОС одновременно
- Упрощение разработки и тестирования

**Недостатки:**
- Накладные расходы на виртуализацию
- Сложность реализации

**Современные примеры:** VMware, VirtualBox, KVM

### Модель клиент-сервер (Микроядро)
**Характеристики:**
- **Минимальное ядро** (микроядро) с базовыми функциями:
  - Управление процессами
  - Управление памятью (базовое)
  - Межпроцессное взаимодействие (IPC)
- **Большинство сервисов** реализовано как серверные процессы в пользовательском режиме:
  - Файловая система
  - Драйверы устройств
  - Сетевые протоколы

**Взаимодействие:**
- Клиенты (приложения) отправляют запросы серверам через микроядро
- Передача сообщений через IPC
- Серверы обрабатывают запросы и отправляют ответы

**Преимущества:**
- **Меньше кода в ядре** → проще верификация и повышение надёжности
- **Отказоустойчивость**: сбой одного сервера не приводит к краху системы
- **Гибкость**: лёгкое добавление и замена сервисов
- **Распределённость**: подходит для распределённых систем

**Недостатки:**
- Накладные расходы на передачу сообщений
- Более низкая производительность по сравнению с монолитными системами

**Примеры:** Minix, Mach, современные микроядерные ОС
### Клиент-сервер для распределённых систем

**Расширение модели клиент-сервер:**
- Клиенты и серверы могут находиться на разных компьютерах
- Взаимодействие через сеть
- Прозрачность для клиентов (не видят, где находится сервер)

**Применение:**
- Распределённые файловые системы
- Распределённые базы данных
- Облачные сервисы
---
## UNIX — важная веха в истории ОС
### Историческая значимость

- **UNIX** была в числе первых ОС вообще
- **Первая ОС, написанная на языке высокого уровня** (язык C, 1971-1973)
- Переносимость — возможность запуска на разных типах компьютеров

### Основные характеристики UNIX
#### 1) Многозадачность
- Несколько программ могут выполняться одновременно (псевдопараллельно)
- Разделение процессорного времени между программами
#### 2) Многопользовательский режим
- Позволяет работать нескольким пользователям одновременно
- Разделение времени между пользователями
- Каждый пользователь имеет свою среду
#### 3) Безопасность

**Защита памяти:**
- Препятствует обращению программы к памяти, выделенной другой программе
- Изоляция процессов

**Защита файлов:**
- Права доступа (чтение, запись, исполнение)
- Владелец, группа, остальные

**Разграничение прав:**
- Проверяет разрешения пользователей на выполнение функций
- Доступ к директориям, файлам, дискам